{"version":3,"file":"vue.js","sources":["../../src/reactivity/computed.js","../../src/shared/shapeFlags.js","../../src/shared/index.js","../../src/reactivity/effect.js","../../src/reactivity/baseHandlers.js","../../src/reactivity/reactive.js","../../src/reactivity/ref.js","../../src/runtime-core/vnode.js","../../src/runtime-core/apiCreateApp.js","../../src/runtime-core/component.js","../../src/runtime-core/renderer.js","../../src/runtime-dom/nodeOps.js","../../src/runtime-dom/pathProps.js","../../src/runtime-dom/index.js","../../src/runtime-core/h.js"],"sourcesContent":["export function computed(){\r\n    \r\n}","export const ShapeFlags = {\r\n    ELEMENT:1,\r\n    FUNCTION_COMPONENT : 1<<1 , //2 \r\n    STATEFUL_COMPONENT:1<<2, //4\r\n    TEXT_CHILDREN:1<<3, // 8\r\n    ARRAY_CHILDREN:1<<4,  // 16\r\n}","export const isObject = (val) =>typeof val==='object'&&val!==null\r\nexport const isSymbol = (val) =>typeof val==='symbol'\r\n\r\nexport const isArray = Array.isArray\r\n\r\nexport const isInteger = (key)=>''+parseInt(key,10)===key\r\n\r\nconst hasOwnProperty = Object.prototype.hasOwnProperty\r\n\r\nexport const hasOwn = (val,key)=>hasOwnProperty.call(val,key)\r\n\r\nexport const hasChanged = (value,oldValue)=>value!==oldValue\r\nexport const isString = (value)=>typeof value==='string'\r\n\r\nexport const isFunction = (value)=>typeof value==='function'\r\nexport * from './shapeFlags'\r\n\r\n","import {isArray, isInteger} from \"../shared/index\";\r\n\r\nexport function effect(fn,options = {}){ // effect =>vue2 watch\r\n    const effect = createReactiveEffect(fn,options)\r\n\r\n    if(!options.lazy){\r\n        effect()\r\n    }\r\n}\r\nlet uid = 0;\r\nlet activeEffect; // 用来存储当前的effect函数\r\nconst effectStack = []\r\nfunction createReactiveEffect(fn,options){\r\n    let effect = function (){\r\n        if(!effectStack.includes(effect)){ // 防止递归执行\r\n            try{\r\n                activeEffect = effect\r\n                effectStack.push(activeEffect)\r\n                return fn() // 用户自己写的逻辑,内部会对数据进行取值操作\r\n            }finally {\r\n                effectStack.pop()\r\n                activeEffect = effectStack[effectStack.length-1]\r\n            }\r\n        }\r\n    }\r\n    effect.id = uid++\r\n    effect.deps = [] // 用来表示effect中依赖了哪些属性\r\n    return effect;\r\n}\r\n// {object:{key:[effect,effect]}}\r\nconst targetMap = new WeakMap()\r\n// 将属性和effect做一个关联\r\nexport function track(target,key){\r\n    if(activeEffect===undefined){\r\n        return false\r\n    }\r\n    let depsMap = targetMap.get(target)\r\n    if(!depsMap){\r\n        targetMap.set(target,(depsMap=new Map()))\r\n    }\r\n    let dep = depsMap.get(key)\r\n    if(!dep){\r\n        depsMap.set(key,(dep=new Set))\r\n    }\r\n    if(!dep.has(activeEffect)){ // 如果没有effect 就把effect放进集合中\r\n        dep.add(activeEffect)\r\n        activeEffect.deps.push(key) // 双向记忆的过程\r\n    }\r\n\r\n    // console.log('targetMap',targetMap)\r\n\r\n}\r\n// 触发依赖收集\r\nexport function trigger(target,type,key,value,oldValue){\r\n\r\n    const depsMap = targetMap.get(target)\r\n    if(!depsMap){ // 判断是否已经进行过收集依赖\r\n        return false\r\n    }\r\n    const run = effects =>{\r\n        if(effects) effects.forEach(effect=>effect())\r\n    }\r\n\r\n    // 数组有特殊的情况\r\n    if(key==='length'&&isArray(target)){\r\n        depsMap.forEach((dep,key)=>{ // map可以循环\r\n            if(key==='length'||key>=value){ // 如果改的长度小于数组原有的长度,应该更新视图\r\n                run(dep)\r\n            }\r\n        })\r\n    }else{\r\n        // 对象的处理\r\n        if(key!==undefined){ // 说明修改了key\r\n            run(depsMap.get(key))\r\n        }\r\n        switch(type){\r\n            case 'add':\r\n                if(isArray(target)){ // 给数组如果通过索引增加选项\r\n                    if(isInteger(key)){\r\n                        // 因为如果页面中直接使用了数组也会对数组进行取值操作\r\n                        // 会对length进行收集 新增属性时直接出发length即可\r\n                        run(depsMap.get('length')) \r\n                    }\r\n                }\r\n                break;\r\n        }\r\n    }\r\n}","\r\n\r\nimport {isSymbol,isObject, hasOwn, hasChanged,isArray,isInteger} from '../shared/index'\r\nimport { reactive } from './reactive'\r\nimport {track, trigger} from './effect'\r\nfunction createGetter(){\r\n    return function get(target,key,receiver){\r\n        const res = Reflect.get(target,key,receiver)\r\n\r\n        // 如果 取得值是symbol类型 我要忽略它\r\n        if(isSymbol(key)){ // 数组中有很多symbol的内置方法\r\n            return res\r\n        }\r\n\r\n        // console.log('=========',target,key)\r\n\r\n        //依赖收集\r\n        track(target,key)\r\n        if(isObject(res)){  //取值是对象进行代理\r\n            return reactive(res)\r\n        }\r\n\r\n        return res\r\n    }\r\n}\r\n\r\nfunction createSetter(){\r\n    return function set(target,key,value,receiver){\r\n\r\n\r\n        const oldValue = target[key] ; // 如果是修改那肯定有老值\r\n        // 看一下有没有这个属性\r\n\r\n\r\n        // 第一种是数组新增的逻辑 第二种是对象的逻辑\r\n        const hadKey = isArray(target)&&isInteger(key)?Number(key)<target.length:hasOwn(target,key)\r\n\r\n\r\n        const res = Reflect.set(target,key,value,receiver)\r\n\r\n        // 新增\r\n        if(!hadKey){\r\n            trigger(target,'add',key,value)\r\n        // 修改   \r\n        }else if(hasChanged(value,oldValue)){\r\n            trigger(target,'set',key,value,oldValue)\r\n        }\r\n\r\n\r\n\r\n        return res\r\n    }\r\n}\r\n\r\nconst get = createGetter()\r\nconst set = createSetter()\r\n\r\nexport const mutableHandlers = {\r\n    get, // 获取对象中的属性会执行此方法\r\n    set //设置属性值得时候会执行此方法\r\n}","import { isObject } from \"../shared/index\"\r\nimport { mutableHandlers } from \"./baseHandlers\"\r\n\r\n\r\n\r\nconst proxyMap = new WeakMap()\r\nexport function reactive(target){\r\n    // 将目标变成响应式 Proxy\r\n    return  createReactiveObject(target,mutableHandlers) // 核心操作就是当读取文件的时候做依赖收集，当数据变化时重新执行effect\r\n}\r\n\r\n\r\nfunction createReactiveObject(target,baseHandlers){\r\n    // 如果不是对象 直接返回出去\r\n    if(!isObject(target)){\r\n        return target\r\n    }\r\n    // 做缓存 看存不存在\r\n    const exisitingProxy = proxyMap.get(target)\r\n    if(exisitingProxy){\r\n        return exisitingProxy\r\n    }\r\n    // 只是对最外层对象做代理 默认不会递归 而且不会重新重写对象中的属性 \r\n    const proxy = new Proxy(target,baseHandlers)\r\n    proxyMap.set(target,proxy) // 将代理的对象和代理后的结果做一个映射表\r\n    return proxy \r\n}","export function ref(target){\r\n\r\n}","import { isArray, isObject, isString, ShapeFlags } from \"../shared/index\"\r\n\r\nexport function createVnode(type,props={},children) {\r\n    // type类型\r\n    const shapeFlag = isString(type)?\r\n    ShapeFlags.ELEMENT:\r\n    isObject(type)?ShapeFlags.STATEFUL_COMPONENT:0\r\n\r\n\r\n    const vnode = { // 虚拟节点可以表示dom结构 也可以用来表示组件\r\n        type,\r\n        props,\r\n        children,\r\n        component:null, // 组件的实例\r\n        el:null,\r\n        key:props.key,\r\n        shapeFlag:shapeFlag // vue3里面非常优秀的做法 虚拟节点的类型 元素 组件\r\n\r\n    }\r\n    if(isArray(children)){\r\n        vnode.shapeFlag|=ShapeFlags.ARRAY_CHILDREN; // 如果在或的过程中有一个是1就是1\r\n        // 把两个数相加\r\n    }else{\r\n        vnode.shapeFlag |=ShapeFlags.TEXT_CHILDREN\r\n    }\r\n    return vnode\r\n}","import { createVnode } from \"./vnode\"\r\n\r\nexport function createAppAPI(render){\r\n    return (rootComponent)=>{\r\n        const app = {\r\n            mount(container){ // 和平台是无关的\r\n\r\n                const vode = createVnode(rootComponent)\r\n                render(vode,container)\r\n\r\n            }\r\n        }\r\n        return app\r\n    }\r\n}","import { isFunction } from \"../shared/index\"\r\n\r\nexport function createComponentInstace(vnode){\r\n    const instance = {\r\n        type:vnode.type,\r\n        props:{},\r\n        vnode,\r\n        render:null,\r\n        setupState:null,\r\n        isMounted:false // 默认组件没有挂载\r\n    }\r\n    return instance\r\n}\r\n\r\n\r\n\r\n\r\nexport const setupComponent = (instance)=>{\r\n    // 1、源码中会对属性进行初始化\r\n    // 2、会对插槽进行初始化\r\n    // 3、调用setup方法\r\n    setupStatefulComponent(instance)\r\n}\r\n\r\n\r\nfunction setupStatefulComponent(instance){\r\n    const Component = instance.type // 组件的虚拟节点\r\n    const {setup} = Component\r\n    if(setup){\r\n        const setUpResult = setup() // 获取setup返回的值\r\n        // 判断返回的值类型\r\n        handleSetupResult(instance,setUpResult)\r\n    }\r\n}\r\n\r\nfunction handleSetupResult(instance,setUpResult){\r\n    if(isFunction(setUpResult)){\r\n        instance.render = setUpResult // 获取render方法\r\n    }else{\r\n        instance.setupState = setUpResult\r\n    }\r\n}","import { effect } from \"../reactivity/index\"\r\n// import { patchProps } from \"../runtime-dom/pathProps\"\r\nimport { ShapeFlags } from \"../shared/index\"\r\nimport { createAppAPI } from \"./apiCreateApp\" // 用户调用的createApp方法\r\nimport { createComponentInstace, setupComponent } from \"./component\"\r\n\r\n// options 是平台传过来的方法 不同的平台可以实现不同的操作逻辑\r\nexport function createRenderer(options){\r\n    return baseCreateRenderer(options)\r\n}\r\n\r\nfunction baseCreateRenderer(options){\r\n    console.log('options',options)\r\n    const {\r\n        createElement:hostCreateElement,\r\n        patchProps:hostPatchProp,\r\n        setElementText:hostSetElementText,\r\n        insert:hostInsert,\r\n        remove:hostRemove\r\n    } = options    \r\n    const patch=(n1,n2,container)=>{\r\n        console.log('n2',n2)\r\n        let {shapeFlag,props} = n2\r\n        const mountElemnt = (vnode,container)=>{\r\n            // vnode 虚拟节点  container 是容器\r\n            let {shapeFlag} = vnode\r\n            let el = vnode.el = hostCreateElement(vnode.type)\r\n\r\n            // 创建儿子节点\r\n            if(shapeFlag&ShapeFlags.TEXT_CHILDREN){\r\n                hostSetElementText(el,vnode.children)\r\n            }else if(shapeFlag&ShapeFlags.ARRAY_CHILDREN){\r\n                mountChildren(vnode.children,el)\r\n            }\r\n            if(props){\r\n                for(let key in props){\r\n                    hostPatchProp(el,key,null,props[key])\r\n                }\r\n            }\r\n\r\n            hostInsert(el,container)\r\n        }\r\n        const mountChildren = (children,container)=>{\r\n            for(let i=0;i<children.length;i++){\r\n                patch(null,children[i],container)\r\n            }\r\n        }\r\n        const patchElemnt= (n1,n2,container)=>{\r\n\r\n        }\r\n        const mountComponent=(initialVnode,container)=>{\r\n            // 组件挂载逻辑 1、创建组件的实例 2、找到组件的render方法 3、执行render\r\n            // 组件实例要记录当前组件的状态\r\n\r\n            const instance = initialVnode.component = createComponentInstace(initialVnode)\r\n\r\n\r\n            setupComponent(instance) // 找到组件的setUp方法\r\n            // 调用render方法 如果render方法中数据变化了 会重新渲染\r\n\r\n            setupRenderEffect(instance,initialVnode,container) // 给组件创建一个effect 用于渲染\r\n\r\n        }\r\n\r\n        const setupRenderEffect = (instance,initialVnode,container)=>{\r\n            effect(function componentEffect(){\r\n                if(!instance.isMounted){\r\n                    // 渲染组件中的内容\r\n                    const subTree = instance.subTree = instance.render() // 组件渲染的结果\r\n                    patch(null,subTree,container)\r\n                    instance.isMounted = true\r\n                }else{\r\n                    // 更新逻辑\r\n                    let prev = instance.subTree // 上一次的渲染结果\r\n                    let next = instance.render \r\n                    // 进行diff比较\r\n                }\r\n\r\n            })\r\n        }\r\n\r\n\r\n\r\n\r\n\r\n        const updateComponent=(n1,n2,container)=>{\r\n\r\n        }\r\n\r\n        const processElement = (n1,n2,container) =>{\r\n            if(n1===null){\r\n                mountElemnt(n2,container)\r\n            }else{\r\n                patchElemnt(n1,n2,container)\r\n            }\r\n        }\r\n        const processComponent =(n1,n2,container)=>{\r\n            if(n1===null){\r\n                mountComponent(n2,container)\r\n            }else{\r\n                updateComponent(n1,n2,container)\r\n            }\r\n        }\r\n\r\n        if(shapeFlag&ShapeFlags.ELEMENT){\r\n            processElement(n1,n2,container)\r\n        }else if(shapeFlag&ShapeFlags.STATEFUL_COMPONENT){\r\n            processComponent(n1,n2,container)\r\n        }\r\n    }\r\n    const render = (vnode,container)=>{\r\n        // 我需要将虚拟节点变成真实节点 挂载到容器中\r\n        patch(null,vnode,container)\r\n    }\r\n    return {\r\n        createApp:createAppAPI(render)\r\n    }\r\n}","export const nodeOps = {\r\n    createElement(type){\r\n        return document.createElement(type)\r\n    },\r\n    setElementText(el,text){\r\n        el.textContent = text\r\n    },\r\n    insert(child,parent,anchor=null){\r\n        parent.insertBefore(child,anchor)\r\n    },\r\n    remove(child){\r\n        const parent = child.parentNode;\r\n        if(parent){\r\n            parent.removeChild(parent)\r\n        }\r\n    }\r\n}","\r\n\r\nfunction patchClass(el,value){\r\n    if(value=== null) value='';\r\n    el.className =value\r\n}   \r\n\r\nfunction patchStyle(el,prev,next){\r\n    const style = el.style\r\n    if(!next){\r\n        el.removeAttribute('style')\r\n    }else{\r\n        for(let key in next){\r\n            style[key] = next[key]\r\n        }\r\n        if(prev){\r\n            for(let key in prev){\r\n                if(next[key]===null){\r\n                    style[key] =''\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\nfunction patchAttr(el,key,value){\r\n    if(value===null){\r\n        el.removeAttribute(key)\r\n    }else{\r\n        el.setAttribute(key,value)\r\n    }\r\n}\r\n\r\nexport function patchProps(el,key,prevValue,nextValue){\r\n    switch(key){\r\n        case 'class':\r\n            patchClass(el,nextValue)\r\n            break;\r\n        case 'style':\r\n            patchStyle(el,prevValue,nextValue)\r\n            break;\r\n        default:\r\n            patchAttr(el,key,nextValue)\r\n            break;        \r\n    }\r\n}","\r\nimport { createRenderer } from '../runtime-core/renderer'\r\nimport {nodeOps} from './nodeOps'\r\nimport {patchProps} from './pathProps'\r\nconst renderOptions = {...nodeOps,patchProps} // dom操作\r\n\r\nfunction ensureRenderer(){\r\n    return createRenderer(renderOptions)\r\n}\r\n\r\n\r\nexport function createApp(rootComponent){\r\n    debugger\r\n    // 1、根据组件创建一个渲染器\r\n    const app = ensureRenderer().createApp(rootComponent)\r\n    const {mount} = app\r\n    app.mount = function(container){\r\n        container = document.querySelector(container)\r\n        // 1、挂载时需要将容器清空 在进行挂载\r\n        container.innerHTML = ''\r\n        mount(container)\r\n    }\r\n    return app\r\n}","import { createVnode } from \"./vnode\";\r\n\r\nexport function h(type,props={},children=null){\r\n    return createVnode(type,props,children)\r\n}"],"names":["computed","ShapeFlags","ELEMENT","FUNCTION_COMPONENT","STATEFUL_COMPONENT","TEXT_CHILDREN","ARRAY_CHILDREN","isObject","val","isSymbol","isArray","Array","isInteger","key","parseInt","hasOwnProperty","Object","prototype","hasOwn","call","hasChanged","value","oldValue","isString","isFunction","effect","fn","options","createReactiveEffect","lazy","uid","activeEffect","effectStack","includes","push","pop","length","id","deps","targetMap","WeakMap","track","target","undefined","depsMap","get","set","Map","dep","Set","has","add","trigger","type","run","effects","forEach","createGetter","receiver","res","Reflect","reactive","createSetter","hadKey","Number","mutableHandlers","proxyMap","createReactiveObject","baseHandlers","exisitingProxy","proxy","Proxy","ref","createVnode","props","children","shapeFlag","vnode","component","el","createAppAPI","render","rootComponent","app","mount","container","vode","createComponentInstace","instance","setupState","isMounted","setupComponent","setupStatefulComponent","Component","setup","setUpResult","handleSetupResult","createRenderer","baseCreateRenderer","console","log","hostCreateElement","createElement","hostPatchProp","patchProps","hostSetElementText","setElementText","hostInsert","insert","hostRemove","remove","patch","n1","n2","mountElemnt","mountChildren","i","mountComponent","initialVnode","setupRenderEffect","componentEffect","subTree","prev","next","processElement","processComponent","createApp","nodeOps","document","text","textContent","child","parent","anchor","insertBefore","parentNode","removeChild","patchClass","className","patchStyle","style","removeAttribute","patchAttr","setAttribute","prevValue","nextValue","renderOptions","ensureRenderer","querySelector","innerHTML","h"],"mappings":"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"}